<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>견적서</title>
    <!-- 이메일 클라이언트의 기본 스타일을 초기화하기 위한 스타일 -->
    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
        background-color: #f4f4f2;
      }
      table {
        border-spacing: 0;
      }
      td {
        padding: 0;
      }
      img {
        border: 0;
      }
      .wrapper {
        width: 100%;
        table-layout: fixed;
        background-color: #f4f4f2;
        padding-bottom: 60px;
      }
      .main {
        background-color: #ffffff;
        margin: 0 auto;
        width: 100%;
        max-width: 600px;
        border-spacing: 0;
        font-family: "Noto Sans KR", sans-serif;
        color: #344e41;
      }
      .two-columns {
        text-align: center;
        font-size: 0;
      }
      .two-columns .column {
        width: 100%;
        max-width: 300px;
        display: inline-block;
        vertical-align: top;
      }
    </style>
  </head>
  <body>
    <center class="wrapper">
      <table class="main" width="100%">
        <!-- HEADER -->
        <tr>
          <td style="padding: 15px 30px">
            <table width="100%">
              <tr>
                <td
                  style="
                    font-size: 25px;
                    font-family: 'Noto Sans KR', Helvetica, sans-serif;
                    color: #344e41;
                  "
                >
                  견적서 승인 요청
                </td>
                <td
                  style="
                    font-size: 14px;
                    font-family: 'Noto Sans KR', Helvetica, sans-serif;
                    color: #344e41;
                    text-align: right;
                  "
                  th:text="${#temporals.format(T(java.time.LocalDateTime).now(), 'yyyy.MM.dd HH:mm')}"
                >
                  2025.07.31 15:00
                </td>
              </tr>
            </table>
          </td>
        </tr>

        <!-- SENDER INFO & EMAIL CONTENT -->
        <tr>
          <td style="padding: 0 15px">
            <table
              width="100%"
              style="
                border-spacing: 0;
                border: 1px solid #e5e7eb;
                border-radius: 10px;
                background-color: #ffffff;
              "
            >
              <tr>
                <td style="padding: 10px 30px">
                  <p
                    style="
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 18px;
                      color: #344e41;
                      margin: 0;
                    "
                    th:text="${sender.user.name}"
                  >
                    김영업
                  </p>
                  <p
                    style="
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                      color: #588157;
                      margin: 5px 0 0 0;
                    "
                    th:text="${sender.user.email}"
                  >
                    rladuddjq@gmail.com
                  </p>
                </td>
              </tr>
              <tr>
                <td style="padding: 5px 30px 20px 30px">
                  <p
                    style="
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                      color: #588157;
                      line-height: 1.5;
                    "
                  >
                    안녕하세요,
                    <span
                      th:text="${estimate.customerName} + ' ' + ${estimate.customerPosition}"
                      >고객명 직위</span
                    >님 <br /><br />
                    요청하신 견적서를 첨부하여 보내드립니다.
                    <br />
                    검토 후 승인 여부를 알려주시면 감사하겠습니다.
                    <br /><br />
                    문의사항이 있으시면 언제든 연락 부탁드립니다.
                    <br /><br />
                    감사합니다.
                  </p>
                </td>
              </tr>
            </table>
          </td>
        </tr>

        <!-- SPACER -->
        <tr>
          <td height="15"></td>
        </tr>

        <!-- QUOTE INFO -->
        <tr>
          <td style="padding: 0 15px">
            <table
              width="100%"
              style="
                border-spacing: 0;
                border: 1px solid #e5e7eb;
                border-radius: 10px;
                background-color: #ffffff;
              "
            >
              <tr>
                <td style="padding: 30px">
                  <!-- 견적서 타이틀 -->
                  <table width="100%" style="margin-bottom: 16px">
                    <tr>
                      <td
                        style="
                          font-family: 'Noto Sans KR', Helvetica, sans-serif;
                          font-size: 18px;
                          color: #3a5a40;
                        "
                      >
                        견적서
                      </td>
                      <td
                        style="
                          font-family: 'Noto Sans KR', Helvetica, sans-serif;
                          font-size: 12px;
                          color: #3a5a40;
                          text-align: right;
                        "
                        th:text="'견적번호: ' + ${estimate.id}"
                      >
                        견적번호: 0001
                      </td>
                    </tr>
                  </table>

                  <!-- 발주처/수주처 정보 -->
                  <table
                    width="100%"
                    style="border-spacing: 0; margin-bottom: 16px"
                  >
                    <tr>
                      <td width="50%" style="padding-right: 10px">
                        <table
                          width="100%"
                          style="
                            border-spacing: 0;
                            background-color: #f4f4f2;
                            border-radius: 10px;
                          "
                        >
                          <tr>
                            <td style="padding: 10px">
                              <p
                                style="
                                  font-family: 'Noto Sans KR', Helvetica,
                                    sans-serif;
                                  font-size: 14px;
                                  color: #3a5a40;
                                  margin: 0 0 10px 0;
                                "
                              >
                                발주처
                              </p>
                              <p
                                style="
                                  font-family: 'Noto Sans KR', Helvetica,
                                    sans-serif;
                                  font-size: 14px;
                                  color: #588157;
                                  line-height: 1.5;
                                  margin: 0;
                                "
                              >
                                <span th:text="${estimate.customerCompanyName}"
                                  >고객사명</span
                                ><br />
                                담당자:
                                <span
                                  th:text="${estimate.customerName} + ' ' + ${estimate.customerPosition}"
                                  >고객명 직위</span
                                ><br />
                                연락처:
                                <span th:text="${estimate.customerPhone}"
                                  >고객 연락처</span
                                >
                              </p>
                            </td>
                          </tr>
                        </table>
                      </td>
                      <td width="50%" style="padding-left: 10px">
                        <table
                          width="100%"
                          style="
                            border-spacing: 0;
                            background-color: #f4f4f2;
                            border-radius: 10px;
                          "
                        >
                          <tr>
                            <td style="padding: 10px">
                              <p
                                style="
                                  font-family: 'Noto Sans KR', Helvetica,
                                    sans-serif;
                                  font-size: 14px;
                                  color: #3a5a40;
                                  margin: 0 0 10px 0;
                                "
                              >
                                수주처
                              </p>
                              <p
                                style="
                                  font-family: 'Noto Sans KR', Helvetica,
                                    sans-serif;
                                  font-size: 14px;
                                  color: #588157;
                                  line-height: 1.5;
                                  margin: 0;
                                "
                              >
                                <span th:text="${company.companyName}"
                                  >우리 회사명</span
                                ><br />
                                담당자:
                                <span
                                  th:text="${sender.user.name} + ' ' + ${sender.position}"
                                  >담당자명 직위</span
                                ><br />
                                연락처:
                                <span th:text="${sender.phoneNumber}"
                                  >담당자 연락처</span
                                >
                              </p>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>

                  <!-- 금액 요약 -->
                  <table
                    width="100%"
                    style="
                      border-spacing: 0;
                      margin-bottom: 16px;
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                      color: black;
                    "
                  >
                    <tr>
                      <td
                        style="
                          padding: 6px 40px 6px 10px;
                          background-color: #f4f4f2;
                          border-radius: 10px;
                        "
                      >
                        <table width="100%">
                          <tr>
                            <td>총 견적 금액</td>
                            <td
                              style="text-align: right"
                              th:text="${#numbers.formatDecimal(totalAmountInfo.totalAmount, 0, 'COMMA', 0, 'POINT')}"
                            >
                              40,480.00
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 40px 6px 10px">
                        <table width="100%">
                          <tr>
                            <td>총 공급가액</td>
                            <td
                              style="text-align: right"
                              th:text="${#numbers.formatDecimal(totalAmountInfo.supplyAmount, 0, 'COMMA', 0, 'POINT')}"
                            >
                              38,000.00
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 40px 6px 10px">
                        <table width="100%">
                          <tr>
                            <td>할인액</td>
                            <td
                              style="text-align: right"
                              th:text="${#numbers.formatDecimal(totalAmountInfo.discountAmount, 0, 'COMMA', 0, 'POINT')}"
                            >
                              1,200.00
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 40px 6px 10px">
                        <table width="100%">
                          <tr>
                            <td>VAT</td>
                            <td
                              style="text-align: right"
                              th:text="${#numbers.formatDecimal(totalAmountInfo.vatAmount, 0, 'COMMA', 0, 'POINT')}"
                            >
                              600.00
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>

                  <!-- 품목 테이블 -->
                  <table
                    width="100%"
                    style="
                      border-spacing: 0;
                      border: 1px solid #f4f4f2;
                      border-radius: 10px;
                      overflow: hidden;
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                    "
                  >
                    <thead>
                      <tr>
                        <th
                          style="
                            background-color: #f4f4f2;
                            color: #3a5a40;
                            padding: 10px;
                            text-align: center;
                          "
                        >
                          품목
                        </th>
                        <th
                          style="
                            background-color: #f4f4f2;
                            color: #3a5a40;
                            padding: 10px;
                            text-align: center;
                          "
                        >
                          수량
                        </th>
                        <th
                          style="
                            background-color: #f4f4f2;
                            color: #3a5a40;
                            padding: 10px;
                            text-align: center;
                          "
                        >
                          단가
                        </th>
                        <th
                          style="
                            background-color: #f4f4f2;
                            color: #3a5a40;
                            padding: 10px;
                            text-align: center;
                          "
                        >
                          공급가액
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr th:each="item : ${estimate.estimateItems}">
                        <td
                          style="
                            padding: 10px;
                            text-align: center;
                            border-top: 1px solid #f4f4f2;
                          "
                          th:text="${item.product.name}"
                        >
                          멋쟁이 사자 인형
                        </td>
                        <td
                          style="
                            padding: 10px;
                            text-align: center;
                            border-top: 1px solid #f4f4f2;
                          "
                          th:text="${item.quantity}"
                        >
                          3
                        </td>
                        <td
                          style="
                            padding: 10px;
                            text-align: center;
                            border-top: 1px solid #f4f4f2;
                          "
                          th:text="${#numbers.formatDecimal(item.unitPrice, 0, 'COMMA', 0, 'POINT')}"
                        >
                          4,000.00
                        </td>
                        <td
                          style="
                            padding: 10px;
                            text-align: center;
                            border-top: 1px solid #f4f4f2;
                          "
                          th:text="${#numbers.formatDecimal(item.subtotal, 0, 'COMMA', 0, 'POINT')}"
                        >
                          12,000.00
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>

        <!-- SPACER -->
        <tr>
          <td height="15"></td>
        </tr>

        <!-- APPROVAL BUTTONS -->
        <tr>
          <td style="padding: 0 15px">
            <table
              width="100%"
              style="
                border-spacing: 0;
                border: 1px solid #e5e7eb;
                border-radius: 10px;
                background-color: #ffffff;
              "
            >
              <tr>
                <td style="padding: 16px; text-align: center">
                  <p
                    style="
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                      color: black;
                      margin: 0 0 16px 0;
                    "
                  >
                    견적서 검토 결과
                  </p>
                  <!-- Thymeleaf로 동적 URL 생성 -->
                  <a
                    th:href="${approveUrl}"
                    style="
                      background-color: #588157;
                      color: white;
                      padding: 10px 20px;
                      text-decoration: none;
                      border-radius: 5px;
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                      margin-right: 10px;
                    "
                    >견적서 승인</a
                  >
                  <a
                    th:href="${rejectUrl}"
                    style="
                      background-color: #ffffff;
                      color: #588157;
                      padding: 8px 18px;
                      text-decoration: none;
                      border-radius: 5px;
                      font-family: 'Noto Sans KR', Helvetica, sans-serif;
                      font-size: 14px;
                      border: 1px solid #588157;
                    "
                    >견적서 거절</a
                  >
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </center>
  </body>
</html>
